---
title: "Untitled"
author: 'Blue Team: Matt Lawson,'
date: "5/6/2019"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
```


# Assigning awards to MLB teams via Data Science

#### Which is the best team: a study of [Giants, Diamondbacks, Dodgers, Padres, and Rockies]

We will each determine an award to give to a team. The team with the most awards is the best team. 

__Most Improved Award (Matt):__

The most improved award goes to the Dodgers. Their improvement score of 30 is 3x higher than the second place team, The Diamondbacks.

```{r warning=F, message=F, echo=F}
columnNames <- c("Year", "League", "Wins", "Losses", "Finish", "Runs per Game", "Number of Games", "Played appearances","At bats", "Runs scored", "Hits", "Doubles", "Tripples", "Home runs", "RBIs", "Stollen bases", "Caught stealing", "Walks", "Strikeouts", "Batting average", "On base %", "Slugging %", "On base + slugging %", "Errors committed", "Double plays", "Fielding %", "Average age")


giants <- read_csv("giants.csv"); names(giants) <-  columnNames
giants <- giants %>% mutate(Team="Giants")  %>% filter(Year != 2019)

db <- read_csv("diamondbacks.csv"); names(db) <-  columnNames
db <- db %>% mutate(Team="Diamondbacks") %>% filter(Year != 2019)


dodgers <- read_csv("dodgers.csv"); names(dodgers) <-  columnNames
dodgers <- dodgers %>% mutate(Team="Dodgers") %>% filter(Year != 2019)


padres <- read_csv("padres.csv"); names(padres) <-  columnNames
padres <- padres %>% mutate(Team="Padres") %>% filter(Year != 2019)

rockies <- read_csv("rockies.csv"); names(rockies) <-  columnNames
rockies <- rockies %>% mutate(Team="Rockies") %>% filter(Year != 2019)


data <- rbind(giants, db, dodgers, padres, rockies)
# giants %>% arrange(Year)
# db %>% arrange(Year)
# dodgers %>% arrange(Year)
# rockies %>% arrange(Year)
# padres %>% arrange(Year)

```




## Matt

### Most Improved Award (1998 to 2018)

It is important to see which teams have gotten better with time and which teams have gotten worse. Once we know that, we can find similarities between improving teams and determine what is important.

```{r}
CalculateImprovement <- function(df, teamName){
  df <- df %>% filter(Year==2018 | Year==1998)
  
  wins <- (df$Wins[1]/df$`Number of Games`[1]) - (df$Wins[2]/df$`Number of Games`[2])
  runsPerGame <- (df$`Runs per Game`[1]/df$`Number of Games`[1]) - (df$`Runs per Game`[2]/df$`Number of Games`[2])
  runsScored <- (df$`Runs scored`[1]/df$`Number of Games`[1]) - (df$`Runs scored`[2]/df$`Number of Games`[2])
  doubles <- (df$Doubles[1]/df$`Number of Games`[1]) - (df$Doubles[2]/df$`Number of Games`[2])
  tripples <-(df$Tripples[1]/df$`Number of Games`[1]) - (df$Tripples[2]/df$`Number of Games`[2])
  homeRuns <- (df$`Home runs`[1]/df$`Number of Games`[1]) - (df$`Home runs`[2]/df$`Number of Games`[2])
  errorsCommitted <- (df$`Errors committed`[1]/df$`Number of Games`[1]) - (df$`Errors committed`[2]/df$`Number of Games`[2])
  
  
   scores <- c(wins, runsPerGame, runsScored, doubles, tripples, homeRuns, -1*errorsCommitted)
  weights <- c(20, 10, 15, 10, 15, 20, 10)

  improvement <- scores %*% weights
  tb <- tribble(~Team, ~Improvement,
                teamName, improvement)
  return(tb)
}
```


```{r}
 mostImproved <- rbind(
   CalculateImprovement(giants,  "Giants"),
   CalculateImprovement(db,  "Diamondbacks"),
   CalculateImprovement(dodgers,  "Dodgers"),
   CalculateImprovement(padres,  "Padres"),
   CalculateImprovement(rockies,  "Rockies")
 )

# mostImproved
 
 ggplot(mostImproved) + 
   geom_bar(aes(x=Team, weight=Improvement, fill=Team))
```

The improvement score is a weighted sum of the (normalized by number of games per season) difference between wins, runs, runs scored, doubles, tripples, homeruns, and errors committed for the 2018 season and the 1998 season. The most improved score goes to the dodgers. Their improvement score is 30, which is 3x bigger than the next largest improvement, The Diamondbacks.